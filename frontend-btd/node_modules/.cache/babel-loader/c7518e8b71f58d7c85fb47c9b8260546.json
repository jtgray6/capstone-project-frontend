{"remainingRequest":"/Users/jeremygray/Flatiron School/Mod5/project/frontend-btd/node_modules/babel-loader/lib/index.js!/Users/jeremygray/Flatiron School/Mod5/project/frontend-btd/node_modules/eslint-loader/index.js??ref--13-0!/Users/jeremygray/Flatiron School/Mod5/project/frontend-btd/src/services/user.service.js","dependencies":[{"path":"/Users/jeremygray/Flatiron School/Mod5/project/frontend-btd/src/services/user.service.js","mtime":1586727016730},{"path":"/Users/jeremygray/Flatiron School/Mod5/project/frontend-btd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jeremygray/Flatiron School/Mod5/project/frontend-btd/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jeremygray/Flatiron School/Mod5/project/frontend-btd/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCB7IGF1dGhIZWFkZXIgfSBmcm9tICcuLi9oZWxwZXJzL2F1dGgtaGVhZGVyJzsKdmFyIGFwaVVSTCA9ICdodHRwOi8vbG9jYWxob3N0OjgwMDAnOwpleHBvcnQgdmFyIHVzZXJTZXJ2aWNlID0gewogIHNpZ251cDogc2lnbnVwLAogIGxvZ2luOiBsb2dpbiwKICBsb2dvdXQ6IGxvZ291dCwKICBnZXRBbGw6IGdldEFsbAp9OwoKZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7CiAgdmFyIHJlcXVlc3RPcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICB9KQogIH07CiAgcmV0dXJuIGZldGNoKCIiLmNvbmNhdChhcGlVUkwsICIvYXBpL3Rva2VuL29idGFpbi8iKSwgcmVxdWVzdE9wdGlvbnMpLnRoZW4oaGFuZGxlUmVzcG9uc2UpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHsKICAgIC8vIGxvZ2luIHN1Y2Nlc3NmdWwgaWYgdGhlcmUncyBhIGp3dCB0b2tlbiBpbiB0aGUgcmVzcG9uc2UKICAgIGlmICh1c2VyLmFjY2VzcykgewogICAgICAvLyBzdG9yZSB1c2VyIGRldGFpbHMgYW5kIGp3dCB0b2tlbiBpbiBsb2NhbCBzdG9yYWdlIHRvIGtlZXAgdXNlciBsb2dnZWQgaW4gYmV0d2VlbiBwYWdlIHJlZnJlc2hlcwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlcicsIEpTT04uc3RyaW5naWZ5KHVzZXIpKTsKICAgIH0KCiAgICByZXR1cm4gdXNlcjsKICB9KTsKfQoKZnVuY3Rpb24gc2lnbnVwKGVtYWlsLCB1c2VybmFtZSwgcGFzc3dvcmQpIHsKICB2YXIgcmVxdWVzdE9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICdQT1NUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfSwKICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgZW1haWw6IGVtYWlsLAogICAgICB1c2VybmFtZTogdXNlcm5hbWUsCiAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgfSkKICB9OwogIHJldHVybiBmZXRjaCgiIi5jb25jYXQoYXBpVVJMLCAiL2FwaS91c2VyL2NyZWF0ZS8iKSwgcmVxdWVzdE9wdGlvbnMpLnRoZW4oaGFuZGxlUmVzcG9uc2UpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHsKICAgIGlmICghdXNlci5lbWFpbCB8fCAhdXNlci51c2VybmFtZSkgewogICAgICByZXR1cm4gY29uc29sZS5sb2coIkVycm9yIHdpdGggc2lnbmluZyB1cCIpOwogICAgfQoKICAgIHJldHVybiB1c2VyOwogIH0pOwp9CgpmdW5jdGlvbiBsb2dvdXQoKSB7CiAgLy8gcmVtb3ZlIHVzZXIgZnJvbSBsb2NhbCBzdG9yYWdlIHRvIGxvZyB1c2VyIG91dAogIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyJyk7Cn0KCmZ1bmN0aW9uIGdldEFsbCgpIHsKICB2YXIgcmVxdWVzdE9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICdHRVQnLAogICAgaGVhZGVyczogYXV0aEhlYWRlcigpCiAgfTsKICByZXR1cm4gZmV0Y2goIiIuY29uY2F0KGFwaVVSTCwgIi9hcGkvaGVsbG8vIiksIHJlcXVlc3RPcHRpb25zKS50aGVuKGhhbmRsZVJlc3BvbnNlKTsKfQoKZnVuY3Rpb24gaGFuZGxlUmVzcG9uc2UocmVzcG9uc2UpIHsKICByZXR1cm4gcmVzcG9uc2UudGV4dCgpLnRoZW4oZnVuY3Rpb24gKHRleHQpIHsKICAgIHZhciBkYXRhID0gdGV4dCAmJiBKU09OLnBhcnNlKHRleHQpOwoKICAgIGlmICghcmVzcG9uc2Uub2spIHsKICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgLy8gYXV0byBsb2dvdXQgaWYgNDAxIHJlc3BvbnNlIHJldHVybmVkIGZyb20gYXBpCiAgICAgICAgbG9nb3V0KCk7CiAgICAgICAgbG9jYXRpb24ucmVsb2FkKHRydWUpOwogICAgICB9CgogICAgICB2YXIgZXJyb3IgPSBkYXRhICYmIGRhdGEubWVzc2FnZSB8fCByZXNwb25zZS5zdGF0dXNUZXh0OwogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwogICAgfQoKICAgIHJldHVybiBkYXRhOwogIH0pOwp9"},{"version":3,"sources":["/Users/jeremygray/Flatiron School/Mod5/project/frontend-btd/src/services/user.service.js"],"names":["authHeader","apiURL","userService","signup","login","logout","getAll","username","password","requestOptions","method","headers","body","JSON","stringify","fetch","then","handleResponse","user","access","localStorage","setItem","email","console","log","removeItem","response","text","data","parse","ok","status","location","reload","error","message","statusText","Promise","reject"],"mappings":";AAAA,SAASA,UAAT,QAA2B,wBAA3B;AACA,IAAMC,MAAM,GAAG,uBAAf;AAEA,OAAO,IAAMC,WAAW,GAAG;AACvBC,EAAAA,MAAM,EAANA,MADuB;AAEvBC,EAAAA,KAAK,EAALA,KAFuB;AAGvBC,EAAAA,MAAM,EAANA,MAHuB;AAIvBC,EAAAA,MAAM,EAANA;AAJuB,CAApB;;AAOP,SAASF,KAAT,CAAeG,QAAf,EAAyBC,QAAzB,EAAmC;AAC/B,MAAMC,cAAc,GAAG;AACnBC,IAAAA,MAAM,EAAE,MADW;AAEnBC,IAAAA,OAAO,EAAE;AAAE,sBAAgB;AAAlB,KAFU;AAGnBC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAEP,MAAAA,QAAQ,EAARA,QAAF;AAAYC,MAAAA,QAAQ,EAARA;AAAZ,KAAf;AAHa,GAAvB;AAMA,SAAOO,KAAK,WAAId,MAAJ,yBAAgCQ,cAAhC,CAAL,CACFO,IADE,CACGC,cADH,EAEFD,IAFE,CAEG,UAAAE,IAAI,EAAI;AACV;AACA,QAAIA,IAAI,CAACC,MAAT,EAAiB;AACb;AACAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6BR,IAAI,CAACC,SAAL,CAAeI,IAAf,CAA7B;AACH;;AAED,WAAOA,IAAP;AACH,GAVE,CAAP;AAWH;;AAED,SAASf,MAAT,CAAgBmB,KAAhB,EAAuBf,QAAvB,EAAiCC,QAAjC,EAA2C;AACvC,MAAMC,cAAc,GAAG;AACnBC,IAAAA,MAAM,EAAE,MADW;AAEnBC,IAAAA,OAAO,EAAE;AAAE,sBAAgB;AAAlB,KAFU;AAGnBC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAEQ,MAAAA,KAAK,EAALA,KAAF;AAASf,MAAAA,QAAQ,EAARA,QAAT;AAAmBC,MAAAA,QAAQ,EAARA;AAAnB,KAAf;AAHa,GAAvB;AAMA,SAAOO,KAAK,WAAId,MAAJ,wBAA+BQ,cAA/B,CAAL,CACFO,IADE,CACGC,cADH,EAEFD,IAFE,CAEG,UAAAE,IAAI,EAAI;AACV,QAAI,CAACA,IAAI,CAACI,KAAN,IAAe,CAACJ,IAAI,CAACX,QAAzB,EAAmC;AAC/B,aAAOgB,OAAO,CAACC,GAAR,CAAY,uBAAZ,CAAP;AACH;;AAED,WAAON,IAAP;AACH,GARE,CAAP;AASH;;AAED,SAASb,MAAT,GAAkB;AACd;AACAe,EAAAA,YAAY,CAACK,UAAb,CAAwB,MAAxB;AACH;;AAED,SAASnB,MAAT,GAAkB;AACd,MAAMG,cAAc,GAAG;AACnBC,IAAAA,MAAM,EAAE,KADW;AAEnBC,IAAAA,OAAO,EAAEX,UAAU;AAFA,GAAvB;AAKA,SAAOe,KAAK,WAAId,MAAJ,kBAAyBQ,cAAzB,CAAL,CAA8CO,IAA9C,CAAmDC,cAAnD,CAAP;AACH;;AAED,SAASA,cAAT,CAAwBS,QAAxB,EAAkC;AAC9B,SAAOA,QAAQ,CAACC,IAAT,GAAgBX,IAAhB,CAAqB,UAAAW,IAAI,EAAI;AAChC,QAAMC,IAAI,GAAGD,IAAI,IAAId,IAAI,CAACgB,KAAL,CAAWF,IAAX,CAArB;;AACA,QAAI,CAACD,QAAQ,CAACI,EAAd,EAAkB;AACd,UAAIJ,QAAQ,CAACK,MAAT,KAAoB,GAAxB,EAA6B;AACzB;AACA1B,QAAAA,MAAM;AACN2B,QAAAA,QAAQ,CAACC,MAAT,CAAgB,IAAhB;AACH;;AAED,UAAMC,KAAK,GAAIN,IAAI,IAAIA,IAAI,CAACO,OAAd,IAA0BT,QAAQ,CAACU,UAAjD;AACA,aAAOC,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP;AACH;;AAED,WAAON,IAAP;AACH,GAdM,CAAP;AAeH","sourcesContent":["import { authHeader } from '../helpers/auth-header';\nconst apiURL = 'http://localhost:8000'\n\nexport const userService = {\n    signup,\n    login,\n    logout,\n    getAll\n};\n\nfunction login(username, password) {\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password })\n    };\n\n    return fetch(`${apiURL}/api/token/obtain/`, requestOptions)\n        .then(handleResponse)\n        .then(user => {\n            // login successful if there's a jwt token in the response\n            if (user.access) {\n                // store user details and jwt token in local storage to keep user logged in between page refreshes\n                localStorage.setItem('user', JSON.stringify(user));\n            }\n\n            return user;\n        });\n}\n\nfunction signup(email, username, password) {\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, username, password })\n    };\n\n    return fetch(`${apiURL}/api/user/create/`, requestOptions)\n        .then(handleResponse)\n        .then(user => {\n            if (!user.email || !user.username) {\n                return console.log(\"Error with signing up\")\n            }\n\n            return user;\n        })\n}\n\nfunction logout() {\n    // remove user from local storage to log user out\n    localStorage.removeItem('user');\n}\n\nfunction getAll() {\n    const requestOptions = {\n        method: 'GET',\n        headers: authHeader()\n    };\n\n    return fetch(`${apiURL}/api/hello/`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n    return response.text().then(text => {\n        const data = text && JSON.parse(text);\n        if (!response.ok) {\n            if (response.status === 401) {\n                // auto logout if 401 response returned from api\n                logout();\n                location.reload(true);\n            }\n\n            const error = (data && data.message) || response.statusText;\n            return Promise.reject(error);\n        }\n\n        return data;\n    });\n}"]}]}