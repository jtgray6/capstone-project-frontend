{"remainingRequest":"/Users/jeremygray/Flatiron School/Mod5/project-frontend/frontend-btd/node_modules/babel-loader/lib/index.js!/Users/jeremygray/Flatiron School/Mod5/project-frontend/frontend-btd/node_modules/eslint-loader/index.js??ref--13-0!/Users/jeremygray/Flatiron School/Mod5/project-frontend/frontend-btd/src/services/user.service.js","dependencies":[{"path":"/Users/jeremygray/Flatiron School/Mod5/project-frontend/frontend-btd/src/services/user.service.js","mtime":1586886526081},{"path":"/Users/jeremygray/Flatiron School/Mod5/project-frontend/frontend-btd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jeremygray/Flatiron School/Mod5/project-frontend/frontend-btd/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jeremygray/Flatiron School/Mod5/project-frontend/frontend-btd/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCB7IGF1dGhIZWFkZXIgfSBmcm9tICcuLi9oZWxwZXJzL2F1dGgtaGVhZGVyJzsKdmFyIGFwaVVSTCA9ICdodHRwOi8vMTI3LjAuMC4xOjgwMDAnOwpleHBvcnQgdmFyIHVzZXJTZXJ2aWNlID0gewogIHNpZ251cDogc2lnbnVwLAogIGxvZ2luOiBsb2dpbiwKICBsb2dvdXQ6IGxvZ291dCwKICBnZXRBbGw6IGdldEFsbAp9OwoKZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7CiAgdmFyIHJlcXVlc3RPcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICB9KQogIH07CiAgcmV0dXJuIGZldGNoKCIiLmNvbmNhdChhcGlVUkwsICIvYXBpL3Rva2VuL29idGFpbi8iKSwgcmVxdWVzdE9wdGlvbnMpLnRoZW4oaGFuZGxlUmVzcG9uc2UpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHsKICAgIGNvbnNvbGUubG9nKHVzZXIpOyAvLyBsb2dpbiBzdWNjZXNzZnVsIGlmIHRoZXJlJ3MgYSBqd3QgdG9rZW4gaW4gdGhlIHJlc3BvbnNlCgogICAgaWYgKHVzZXIuYWNjZXNzKSB7CiAgICAgIC8vIHN0b3JlIHVzZXIgZGV0YWlscyBhbmQgand0IHRva2VuIGluIGxvY2FsIHN0b3JhZ2UgdG8ga2VlcCB1c2VyIGxvZ2dlZCBpbiBiZXR3ZWVuIHBhZ2UgcmVmcmVzaGVzCiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyJywgSlNPTi5zdHJpbmdpZnkodXNlcikpOwogICAgfQoKICAgIHJldHVybiB1c2VyOwogIH0pOwp9CgpmdW5jdGlvbiBzaWdudXAoZW1haWwsIHVzZXJuYW1lLCBwYXNzd29yZCkgewogIHZhciByZXF1ZXN0T3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ1BPU1QnLAogICAgaGVhZGVyczogewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICB9LAogICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICBlbWFpbDogZW1haWwsCiAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICB9KQogIH07CiAgcmV0dXJuIGZldGNoKCIiLmNvbmNhdChhcGlVUkwsICIvYXBpL3VzZXIvY3JlYXRlLyIpLCByZXF1ZXN0T3B0aW9ucykudGhlbihoYW5kbGVSZXNwb25zZSkudGhlbihmdW5jdGlvbiAodXNlcikgewogICAgaWYgKCF1c2VyLmVtYWlsIHx8ICF1c2VyLnVzZXJuYW1lKSB7CiAgICAgIHJldHVybiBjb25zb2xlLmxvZygiRXJyb3Igd2l0aCBzaWduaW5nIHVwIik7CiAgICB9CgogICAgcmV0dXJuIHVzZXI7CiAgfSk7Cn0KCmZ1bmN0aW9uIGxvZ291dCgpIHsKICAvLyByZW1vdmUgdXNlciBmcm9tIGxvY2FsIHN0b3JhZ2UgdG8gbG9nIHVzZXIgb3V0CiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXInKTsKfQoKZnVuY3Rpb24gZ2V0QWxsKCkgewogIHZhciByZXF1ZXN0T3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ0dFVCcsCiAgICBoZWFkZXJzOiBhdXRoSGVhZGVyKCkKICB9OwogIHJldHVybiBmZXRjaCgiIi5jb25jYXQoYXBpVVJMLCAiL2FwaS9oZWxsby8iKSwgcmVxdWVzdE9wdGlvbnMpLnRoZW4oaGFuZGxlUmVzcG9uc2UpOwp9CgpmdW5jdGlvbiBoYW5kbGVSZXNwb25zZShyZXNwb25zZSkgewogIHJldHVybiByZXNwb25zZS50ZXh0KCkudGhlbihmdW5jdGlvbiAodGV4dCkgewogICAgdmFyIGRhdGEgPSB0ZXh0ICYmIEpTT04ucGFyc2UodGV4dCk7CgogICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAvLyBhdXRvIGxvZ291dCBpZiA0MDEgcmVzcG9uc2UgcmV0dXJuZWQgZnJvbSBhcGkKICAgICAgICBsb2dvdXQoKTsKICAgICAgICBsb2NhdGlvbi5yZWxvYWQodHJ1ZSk7CiAgICAgIH0KCiAgICAgIHZhciBlcnJvciA9IGRhdGEgJiYgZGF0YS5tZXNzYWdlIHx8IHJlc3BvbnNlLnN0YXR1c1RleHQ7CiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfSk7Cn0="},{"version":3,"sources":["/Users/jeremygray/Flatiron School/Mod5/project-frontend/frontend-btd/src/services/user.service.js"],"names":["authHeader","apiURL","userService","signup","login","logout","getAll","username","password","requestOptions","method","headers","body","JSON","stringify","fetch","then","handleResponse","user","console","log","access","localStorage","setItem","email","removeItem","response","text","data","parse","ok","status","location","reload","error","message","statusText","Promise","reject"],"mappings":"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","sourcesContent":["import { authHeader } from '../helpers/auth-header';\nconst apiURL = 'http://127.0.0.1:8000'\n\nexport const userService = {\n    signup,\n    login,\n    logout,\n    getAll\n};\n\nfunction login(username, password) {\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password })\n    };\n\n    return fetch(`${apiURL}/api/token/obtain/`, requestOptions)\n        .then(handleResponse)\n        .then(user => {\n            console.log(user)\n            // login successful if there's a jwt token in the response\n            if (user.access) {\n                // store user details and jwt token in local storage to keep user logged in between page refreshes\n                localStorage.setItem('user', JSON.stringify(user));\n            }\n\n            return user;\n        });\n}\n\nfunction signup(email, username, password) {\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, username, password })\n    };\n\n    return fetch(`${apiURL}/api/user/create/`, requestOptions)\n        .then(handleResponse)\n        .then(user => {\n            if (!user.email || !user.username) {\n                return console.log(\"Error with signing up\")\n            }\n\n            return user;\n        })\n}\n\nfunction logout() {\n    // remove user from local storage to log user out\n    localStorage.removeItem('user');\n}\n\nfunction getAll() {\n    const requestOptions = {\n        method: 'GET',\n        headers: authHeader()\n    };\n\n    return fetch(`${apiURL}/api/hello/`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n    return response.text().then(text => {\n        const data = text && JSON.parse(text);\n        if (!response.ok) {\n            if (response.status === 401) {\n                // auto logout if 401 response returned from api\n                logout();\n                location.reload(true);\n            }\n\n            const error = (data && data.message) || response.statusText;\n            return Promise.reject(error);\n        }\n\n        return data;\n    });\n}"]}]}